import{p as E,d as l,u as B,q as N,s as S,w as V,n as j,c as p,b as s,v as h,k as z,g as n,f as r,F as I,e as C,h as L,o as f}from"./index-h4EnpgFa.js";import{b as M,c as O}from"./panel.esm-up7nN6RI.js";import{s as P,b as R}from"./bg-_nfMGeqk.js";import{a as T,_ as F}from"./AppCandidatesSelector-QVteDIRS.js";import{_ as H}from"./_plugin-vue_export-helper-x3n3nnut.js";const U={class:"issue-name-zone justify-content-center"},q={class:"text-4xl"},A={class:"flex justify-content-center mb-6"},D={style:{"z-index":"1",position:"relative"}},G={class:"grid"},J={class:"lg:col-offset-3 lg:col-6 md:col-offset-2 md:col-8 col-offset-1 col-10"},K=["innerHTML"],Q={__name:"ElectionIssue",setup(W){const y=E(),u=l(null),w=l(null),i=l(null),a=l(null),c=l(!1),d=B(),m=t=>{w.value=Number(t.electionId),i.value=Number(t.issueId)};N(()=>m(y.params)),S((t,e)=>{m(t.params),u.value=null}),V(i,()=>a.value=d.getIssue(i.value));const x=j(()=>{if(!d.currentElection.opinions)return[];let t=d.currentElection.opinions.filter(e=>u.value?e.author_id==u.value:!0).filter(e=>e.issue_id==i.value);return Object.groupBy(t,e=>e.author_id)}),v=l({}),k=t=>{var e;(e=v.value[t])==null||e.scrollIntoView({behavior:"smooth"})};return(t,e)=>{var _,b;return f(),p(I,null,[s("div",{class:"background-image pt-2 w-full",style:h({backgroundImage:`url(${r(R)})`})},[s("div",{class:"issue-image",style:h({backgroundImage:`url(${(_=a.value)==null?void 0:_.photo})`})},null,4),s("div",U,[s("div",null,[s("span",q,z((b=a.value)==null?void 0:b.title),1)]),s("div",null,[n(r(M),{label:"Plus d'infos",text:"",severity:"primary",onClick:e[0]||(e[0]=o=>c.value=!0)})])]),s("div",A,[n(T,{onScroll:e[1]||(e[1]=o=>k(o))})]),s("div",D,[s("div",G,[s("div",J,[(f(!0),p(I,null,C(x.value,(o,g)=>(f(),p("div",{ref_for:!0,ref:$=>v.value[g]=$},[n(F,{opinions:o,candidateId:Number(g),collapsed:!1},null,8,["opinions","candidateId"])],512))),256))])])]),n(r(P),{visible:c.value,"onUpdate:visible":e[2]||(e[2]=o=>c.value=o),header:"Plus d'infos",class:"w-full md:w-20rem lg:w-30rem"},{default:L(()=>{var o;return[s("p",{style:{"white-space":"pre-wrap"},innerHTML:(o=a.value)==null?void 0:o.short_description},null,8,K)]}),_:1},8,["visible"])],4),n(r(O))],64)}}},te=H(Q,[["__scopeId","data-v-3350fcda"]]);export{te as default};
