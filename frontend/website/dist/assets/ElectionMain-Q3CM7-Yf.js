import{i as C,t as j,r as x,u as S,w as E,o as n,c,F as g,a as I,b as e,d as _,e as O,f as l,g as a,h as F,j as B,s as G,k as w,l as A,m as T,n as V,p as z,q}from"./index-8589Tib9.js";import{s as M,a as N}from"./AppOpinion-IlAdLfRx.js";import{_ as D,a as L}from"./AppIssuesSelector-Hc_yuUNZ.js";import{_ as P,a as H}from"./carouselstyle.esm-BPVaCXTj.js";const J={class:"flex align-items-center"},K={class:"flex flex-column"},Q={key:0,class:"font-bold ml-4 font-light uppercase text-sm",style:{color:"#797979"}},U={__name:"ElectionMainOpinionsByAuthor",props:{groupedOpinions:{type:Object,default:{}},scrollToAuthorId:{type:Number}},emits:["onScrollFinish"],setup(b,{emit:h}){const f=C("$groupArrayBy"),$=b,d=h,{groupedOpinions:v,scrollToAuthorId:u}=j($),r=x({}),i=S();E(u,()=>{var m;u.value&&((m=r.value[u.value])==null||m.scrollIntoView({behavior:"smooth"}),d("onScrollFinish"))});const p=(m=[])=>m.map(t=>Number(t.num_proposals)).filter(t=>!!t).reduce((t,s)=>t+s,0);return(m,t)=>(n(),c(g,null,[(n(!0),c(g,null,I(e(v),(s,o)=>(n(),c("div",{class:"mb-4",ref_for:!0,ref:y=>r.value[o]=y},[e(i).getCandidate(o)?(n(),_(e(V),{key:0},{content:O(()=>{var y;return[l("div",J,[a(e(M),{image:(y=e(i).getCandidate(o))==null?void 0:y.photo,size:"xlarge",shape:"rectangle",class:"mr-2"},null,8,["image"]),l("div",K,[a(e(A),{text:"",onClick:k=>e(w).push(`/election/${e(i).currentElection.id}/candidate/${o}`)},{default:O(()=>[F(B(e(i).getCandidateName(o))+" ",1),a(e(G),{value:p(s),severity:"success"},null,8,["value"])]),_:2},1032,["onClick"]),e(i).hasCandidateOrganisations(o)?(n(),c("span",Q,B(e(i).getCandidateOrganisationsStr(o)),1)):T("",!0)])]),(n(!0),c(g,null,I(e(f)(s,k=>k.issue_id),(k,R)=>(n(),_(D,{opinions:k,issueId:Number(R)},null,8,["opinions","issueId"]))),256))]}),_:2},1024)):T("",!0)],512))),256)),a(e(z))],64))}},W={class:"flex align-items-center"},X={__name:"ElectionMainOpinionsByIssue",props:{groupedOpinions:{type:Object,default:{}},scrollToIssueId:{type:Number}},emits:["onScrollFinish"],setup(b,{emit:h}){const f=C("$groupArrayBy"),$=b,d=h,{groupedOpinions:v,scrollToIssueId:u}=j($),r=S(),i=x({});return E(u,()=>{var p;u.value&&((p=i.value[u.value])==null||p.scrollIntoView({behavior:"smooth"}),d("onScrollFinish"))}),(p,m)=>(n(),c(g,null,[(n(!0),c(g,null,I(e(v),(t,s)=>(n(),c("div",{class:"mb-4",ref_for:!0,ref:o=>i.value[s]=o},[e(r).getIssue(s)?(n(),_(e(V),{key:0},{content:O(()=>[l("div",W,[a(e(M),{image:e(r).getIssueImage(s),size:"xlarge",shape:"rectangle",class:"mr-2"},null,8,["image"]),a(e(A),{text:"",onClick:o=>e(w).push(`/election/${e(r).currentElection.id}/issue/${s}`)},{default:O(()=>[F(B(e(r).getIssueTitle(s)),1)]),_:2},1032,["onClick"])]),(n(!0),c(g,null,I(e(f)(t,o=>o.author_id),(o,y)=>(n(),_(P,{opinions:o,candidateId:Number(y)},null,8,["opinions","candidateId"]))),256))]),_:2},1024)):T("",!0)],512))),256)),a(e(z))],64))}},Y={class:"flex flex-column"},Z=l("div",{class:"flex justify-content-center"},[l("h5",null,"Afficher les opinions par:")],-1),ee={class:"flex justify-content-center"},se=l("div",{class:"flex justify-content-center"},[l("h5",null,"Aller à:")],-1),oe={class:"flex flex-wrap justify-content-center mb-4",style:{"max-width":"800px",margin:"auto"}},te={class:"flex"},ne={class:"lg:col-offset-3 lg:col-6 md:col-offset-2 md:col-8 col"},ue={__name:"ElectionMain",setup(b){const h=C("$groupArrayBy"),f=x("author_id"),$=S(),d=t=>f.value==t,v=(t,s)=>{f.value=t,s.target.blur()},u=q(()=>h($.currentElection.opinions,t=>t[f.value])),r=x(null),i=t=>{r.value=t},p=x(null),m=t=>{p.value=t};return(t,s)=>(n(),c(g,null,[l("div",Y,[Z,l("div",ee,[a(e(A),{severity:d("author_id")?"primary":"secondary",label:"Candidat",class:"mx-2",onClick:s[0]||(s[0]=o=>v("author_id",o)),rounded:"",size:"small"},null,8,["severity"]),a(e(A),{severity:d("issue_id")?"primary":"secondary",label:"Thème",class:"mx-2",onClick:s[1]||(s[1]=o=>v("issue_id",o)),rounded:"",size:"small"},null,8,["severity"])]),a(e(N)),se,l("div",oe,[d("author_id")?(n(),_(H,{key:0,onScroll:s[2]||(s[2]=o=>i(o))})):(n(),_(L,{key:1,onScroll:s[3]||(s[3]=o=>m(o))}))])]),a(e(N)),l("div",te,[l("div",ne,[d("author_id")?(n(),_(U,{key:0,groupedOpinions:u.value,scrollToAuthorId:r.value,onOnScrollFinish:s[4]||(s[4]=o=>r.value=null)},null,8,["groupedOpinions","scrollToAuthorId"])):(n(),_(X,{key:1,groupedOpinions:u.value,scrollToIssueId:p.value,onOnScrollFinish:s[5]||(s[5]=o=>p.value=null)},null,8,["groupedOpinions","scrollToIssueId"]))])])],64))}};export{ue as default};
