import{_ as N,i as V,x as j,r as l,d as k,y as C,z as S,w as z,v as A,c as r,a as s,n as L,j as M,b as i,u as v,F as x,e as P,g as R,o as u,m as T,B as F,q as H}from"./index-xhV3R-7P.js";import{a as O,_ as U}from"./carouselstyle.esm--iYnb4Wm.js";import"./AppOpinion-os6PB95B.js";const q={class:"pt-2 w-full"},D={class:"issue-name-zone justify-content-center"},G=["src"],J={class:"text-4xl"},K={class:"flex flex-wrap justify-content-center mb-6",style:{"max-width":"800px",margin:"auto"}},Q={style:{"z-index":"1",position:"relative"}},W={class:"flex"},X={class:"lg:col-offset-3 lg:col-6 md:col-offset-2 md:col-8 col"},Y=["innerHTML"],Z={__name:"ElectionIssue",setup(ee){const b=V("$groupArrayBy"),g=j(),c=l(null),I=l(null),a=l(null),n=l(null),d=l(!1),p=k(),_=t=>{I.value=Number(t.electionId),a.value=Number(t.issueId)};C(()=>{_(g.params),window.scroll({top:0,behavior:"smooth"})}),S((t,e)=>{_(t.params),c.value=null}),z(a,()=>n.value=p.getIssue(a.value));const B=A(()=>{if(!p.currentElection.opinions)return[];let t=p.currentElection.opinions.filter(e=>c.value?e.author_id==c.value:!0).filter(e=>e.issue_id==a.value);return b(t,e=>e.author_id)}),f=l({}),$=t=>{var e;(e=f.value[t])==null||e.scrollIntoView({behavior:"smooth"})};return(t,e)=>{var m,h,w;return u(),r(x,null,[s("div",q,[s("div",D,[(m=n.value)!=null&&m.photo?(u(),r("img",{key:0,src:(h=n.value)==null?void 0:h.photo,width:"150"},null,8,G)):L("",!0),s("div",null,[s("span",J,M((w=n.value)==null?void 0:w.title),1)]),s("div",null,[i(v(T),{label:"Plus d'infos",text:"",severity:"primary",onClick:e[0]||(e[0]=o=>d.value=!0)})])]),s("div",K,[i(O,{onScroll:e[1]||(e[1]=o=>$(o))})]),s("div",Q,[s("div",W,[s("div",X,[(u(!0),r(x,null,P(B.value,(o,y)=>(u(),r("div",{ref_for:!0,ref:E=>f.value[y]=E},[i(U,{opinions:o,candidateId:Number(y),collapsed:!1},null,8,["opinions","candidateId"])],512))),256))])])]),i(v(F),{visible:d.value,"onUpdate:visible":e[2]||(e[2]=o=>d.value=o),header:"Plus d'infos",class:"w-11 md:w-20rem lg:w-30rem"},{default:R(()=>{var o;return[s("p",{style:{"white-space":"pre-wrap"},innerHTML:(o=n.value)==null?void 0:o.short_description},null,8,Y)]}),_:1},8,["visible"])]),i(v(H))],64)}}},le=N(Z,[["__scopeId","data-v-c1630f29"]]);export{le as default};
