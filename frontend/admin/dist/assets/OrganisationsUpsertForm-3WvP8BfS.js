import{c as M,a as d,d as B,u as P,s as z}from"./message.esm-UrD84rNF.js";import{b as m,s as W}from"./index.esm-Kf8LRFWe.js";import{s as X}from"./textarea.esm-EobiClLN.js";import{s as G}from"./radiobutton.esm-7Z-Av-VZ.js";import{d as H}from"./AppTableSkeleton-Nfvta1m-.js";import{s as J}from"./inputmask.esm-i6YiUls-.js";import{r as p,X as K,o as Q,A as E,a as _,c as v,b as a,E as x,F as N,n as R,g as s,f as l,V as i,e as Y,w as Z,h as ee}from"./index-sjrDLI-L.js";import{u as te}from"./OrganisationsView-cPVXtV4e.js";const le={style:{width:"450px"}},ae=["initial-values"],oe={class:"field"},se={class:"formgrid grid"},ie={class:"field-radiobutton col-6"},ne={for:"type1"},de={class:"field"},re=a("label",{for:"title"},"Nom",-1),ue={class:"field"},ce=a("label",{for:"description"},"Description",-1),me={class:"formgrid grid"},pe={class:"field col"},_e=a("label",{for:"title"},"Téléphone",-1),fe={class:"field col"},ve=a("label",{for:"title"},"Email",-1),be={class:"formgrid grid"},ge={class:"field col-6"},Ve=a("label",{for:"title"},"Website",-1),he={class:"field col-6"},we=a("label",{for:"title"},"Facebook",-1),ye={class:"field col-6"},ke=a("label",{for:"title"},"Twitter",-1),Ae={class:"field col-6"},Ue=a("label",{for:"title"},"Instagram",-1),$e={class:"field"},xe=a("label",{for:"title"},"Organisation parent",-1),Ge={__name:"OrganisationsUpsertForm",setup(Se){const C=M({name:d().required(),type:d().required(),description:d(),twitter:d(),facebook:d(),instagram:d(),website:d(),address:d(),contact_phone:B(),contact_email:d().email(),parent_organisation_id:B()}),{handleSubmit:I,errors:j,defineField:o,setFieldValue:S}=P({validationSchema:C}),[b,Fe]=o("name"),[g,Oe]=o("type"),[V,Te]=o("description"),[h,Be]=o("twitter"),[w,Ee]=o("facebook"),[y,Ne]=o("instagram"),[k,Re]=o("website");o("address");const[A,Ce]=o("contact_phone"),[U,Ie]=o("contact_email"),[$,je]=o("parent_organisation_id"),F=te(),u=p(null),O=p([]),q=p({}),r=K("dialogRef");Q(()=>{var c,e,t;["name","type","description","twitter","facebook","instagram","website","address","contact_phone","contact_email","parent_organisation_id"].forEach(n=>{r.value.data[n]&&S(n,r.value.data[n])}),S("type",((c=r.value.data)==null?void 0:c.type)=="click"?"party":(e=r.value.data)==null?void 0:e.type),u.value=(t=r.value.data)==null?void 0:t.id,O.value=u.value?F.organisations.filter(n=>n.id!=u.value):F.organisations});const f=p(!1),T=I(c=>{f.value=!0,u.value?E.organisations.updateOrganisation({...c,id:u.value}).then(e=>{r.value.close("success")}).finally(()=>f.value=!1):E.organisations.addOrganisation(c).then(e=>{r.value.close("success")}).finally(()=>f.value=!1)}),D=p([{label:"Parti",value:"party"},{label:"Institution",value:"institution"},{label:"Association",value:"association"},{label:"Coalition",value:"coalition"},{label:"Think Tank",value:"think_tank"}]);return(c,e)=>(_(),v("div",le,[a("h5",null,x(u.value?"Modifier":"Ajouter")+" une organisation",1),a("form",{onSubmit:e[10]||(e[10]=(...t)=>l(T)&&l(T)(...t)),"initial-values":q.value.value},[a("div",oe,[a("div",se,[(_(!0),v(N,null,R(D.value,(t,n)=>(_(),v("div",ie,[s(l(G),{id:`type${n}`,name:"type",modelValue:l(g),"onUpdate:modelValue":e[0]||(e[0]=L=>i(g)?g.value=L:null),value:t.value},null,8,["id","modelValue","value"]),a("label",ne,x(t.label),1)]))),256))])]),a("div",de,[re,s(l(m),{id:"name",type:"text",modelValue:l(b),"onUpdate:modelValue":e[1]||(e[1]=t=>i(b)?b.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",ue,[ce,s(l(X),{id:"description",modelValue:l(V),"onUpdate:modelValue":e[2]||(e[2]=t=>i(V)?V.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),a("div",me,[a("div",pe,[_e,s(l(J),{id:"contact_phone",modelValue:l(A),"onUpdate:modelValue":e[3]||(e[3]=t=>i(A)?A.value=t:null),class:"w-full",mask:"221 999 99 99",placeholder:"221 999 99 99"},null,8,["modelValue"])]),a("div",fe,[ve,s(l(m),{id:"contact_email",type:"email",modelValue:l(U),"onUpdate:modelValue":e[4]||(e[4]=t=>i(U)?U.value=t:null),class:"w-full"},null,8,["modelValue"])])]),a("div",be,[a("div",ge,[Ve,s(l(m),{id:"website",type:"url",modelValue:l(k),"onUpdate:modelValue":e[5]||(e[5]=t=>i(k)?k.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",he,[we,s(l(m),{id:"facebook",type:"text",modelValue:l(w),"onUpdate:modelValue":e[6]||(e[6]=t=>i(w)?w.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",ye,[ke,s(l(m),{id:"twitter",type:"text",modelValue:l(h),"onUpdate:modelValue":e[7]||(e[7]=t=>i(h)?h.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",Ae,[Ue,s(l(m),{id:"instagram",type:"text",modelValue:l(y),"onUpdate:modelValue":e[8]||(e[8]=t=>i(y)?y.value=t:null),class:"w-full"},null,8,["modelValue"])])]),a("div",$e,[xe,s(l(H),{modelValue:l($),"onUpdate:modelValue":e[9]||(e[9]=t=>i($)?$.value=t:null),options:O.value,optionLabel:"name",optionValue:"id",placeholder:"Choisir une organisation",class:"w-full"},null,8,["modelValue","options"])]),s(l(W),{type:"submit",label:"Soumettre",class:"w-full",loading:f.value},null,8,["loading"])],40,ae),(_(!0),v(N,null,R(l(j),(t,n)=>(_(),Y(l(z),{severity:"error",key:n},{default:Z(()=>[ee(x(t),1)]),_:2},1024))),128))]))}};export{Ge as default};
