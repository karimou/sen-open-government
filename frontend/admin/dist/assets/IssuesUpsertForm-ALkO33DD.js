import{c as $,a as m,u as k,s as B}from"./message.esm-Z2CAW3Ck.js";import{b as I,s as R}from"./index.esm-2ozWNLcu.js";import{s as U}from"./textarea.esm-Z8MDRICx.js";import{s as q}from"./editor.esm-R1dHfCbt.js";import{r as _,Y as D,a as N,A as g,o as f,c as V,b as l,t as b,g as n,f as t,W as v,F as j,p as E,e as M,w as T,h as z}from"./index-SBcS5hmR.js";const C={style:{width:"650px"}},L=["initial-values"],P={class:"field"},W=l("label",{for:"title"},"Titre",-1),Y={class:"field"},G=l("label",{for:"short_description"},"Description courte",-1),H={class:"field"},J=l("label",{for:"short_description"},"Description longue",-1),oe={__name:"IssuesUpsertForm",setup(K){const y=$({title:m().required(),short_description:m().required(),long_description:m()}),{handleSubmit:x,errors:S,defineField:u,setFieldValue:w}=k({validationSchema:y}),[d,O]=u("title"),[c,Q]=u("short_description"),[p,X]=u("long_description"),a=_(null),A=_({}),i=D("dialogRef");N(()=>{var o;["title","short_description","long_description"].forEach(e=>{i.value.data[e]&&w(e,i.value.data[e])}),a.value=(o=i.value.data)==null?void 0:o.id});const r=_(!1),h=x(o=>{r.value=!0,a.value?g.issues.updateIssue({...o,id:a.value}).then(e=>{i.value.close("success")}).finally(()=>r.value=!1):g.issues.addIssue(o).then(e=>{i.value.close("success")}).finally(()=>r.value=!1)});return(o,e)=>(f(),V("div",C,[l("h5",null,b(a.value?"Modifier":"Ajouter")+" un thÃ¨me politique",1),l("form",{onSubmit:e[3]||(e[3]=(...s)=>t(h)&&t(h)(...s)),"initial-values":A.value.value},[l("div",P,[W,n(t(I),{id:"title",type:"text",modelValue:t(d),"onUpdate:modelValue":e[0]||(e[0]=s=>v(d)?d.value=s:null),class:"w-full"},null,8,["modelValue"])]),l("div",Y,[G,n(t(U),{id:"short_description",modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=s=>v(c)?c.value=s:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),l("div",H,[J,n(t(q),{modelValue:t(p),"onUpdate:modelValue":e[2]||(e[2]=s=>v(p)?p.value=s:null),id:"long_description",editorStyle:"height: 320px"},null,8,["modelValue"])]),n(t(R),{type:"submit",label:"Soumettre",class:"w-full",loading:r.value},null,8,["loading"])],40,L),(f(!0),V(j,null,E(t(S),(s,F)=>(f(),M(t(B),{severity:"error",key:F},{default:T(()=>[z(b(s),1)]),_:2},1024))),128))]))}};export{oe as default};
