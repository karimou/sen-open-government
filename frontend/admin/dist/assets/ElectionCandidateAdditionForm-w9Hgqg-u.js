import{r as V,X as N,o as R,A as U,u as $,a as t,c as l,b as i,f as e,e as d,w as h,E as a,V as g,g as k,F as j,n as D,h as P,i as q,_ as T}from"./index-mqQjfPOb.js";import{c as M,d as b,u as O}from"./index.esm-YLBYxjLo.js";import{s as C}from"./index.esm-8WYIV_VM.js";import{c as m}from"./AppTableSkeleton-i4JGvXbu.js";import{s as X}from"./message.esm-m1pzN4mq.js";import{u as z}from"./persons-vmc6YvXU.js";import{u as G}from"./ElectionsView-G2B7moi8.js";const H={style:{width:"350px"}},J=i("h5",null,"Ajouter un candidat",-1),K=["initial-values"],Q={class:"field"},W=i("label",{for:"title"},"Candidat",-1),Y={key:0},Z={key:1},ee={key:0},oe={key:1},se={class:"field"},te=i("label",{for:"title"},"Élection",-1),fe={__name:"ElectionCandidateAdditionForm",setup(ne){const S=M({electionId:b().required(),personId:b().required()}),{handleSubmit:A,errors:w,defineField:v,setFieldValue:I}=O({validationSchema:S}),[u,le]=v("electionId"),[c,ae]=v("personId"),n=z(),p=G(),E=V({}),r=N("dialogRef");R(()=>{r.value.data.electionId&&I("electionId",r.value.data.electionId),r.value.data.personId&&I("personId",r.value.data.personId),n.persons||n.refreshPersons(),p.elections||p.refreshElections()});const f=V(!1),y=A(_=>{f.value=!0,U.elections.addElectionCandidate({electionId:u.value,personId:c.value}).then(s=>{r.value.close("success")}).finally(()=>f.value=!1)}),F=$(),x=q(()=>T(()=>import("./PersonsUpsertForm-M0-zy1iQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),B=(_={})=>{F.open(x,{data:_,onClose:s=>{(s==null?void 0:s.data)=="success"&&n.refreshPersons()},props:{modal:!0}})};return(_,s)=>(t(),l("div",H,[J,i("form",{onSubmit:s[2]||(s[2]=(...o)=>e(y)&&e(y)(...o)),"initial-values":E.value.value},[i("div",Q,[W,e(n).persons?(t(),d(e(m),{key:1,modelValue:e(c),"onUpdate:modelValue":s[0]||(s[0]=o=>g(c)?c.value=o:null),options:e(n).persons,optionLabel:"firstname",optionValue:"id",placeholder:"Choisir une personne",class:"w-full",filter:""},{value:h(o=>[o.value?(t(),l("span",Y,a(e(n).personsNames[o.value]),1)):(t(),l("span",Z,a(o.placeholder),1))]),option:h(o=>[o.option?(t(),l("span",ee,a(o.option.firstname)+" "+a(o.option.lastname),1)):(t(),l("span",oe,a(o.placeholder),1))]),_:1},8,["modelValue","options"])):(t(),d(e(m),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"})),k(e(C),{label:"Ajouter une personne",icon:"pi pi-plus",text:"",onClick:B})]),i("div",se,[te,e(p).elections?(t(),d(e(m),{key:1,modelValue:e(u),"onUpdate:modelValue":s[1]||(s[1]=o=>g(u)?u.value=o:null),options:e(p).elections,optionLabel:"title",optionValue:"id",placeholder:"Choisir une élection",class:"w-full",filter:""},null,8,["modelValue","options"])):(t(),d(e(m),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"}))]),k(e(C),{type:"submit",label:"Soumettre",class:"w-full",loading:f.value},null,8,["loading"])],40,K),(t(!0),l(j,null,D(e(w),(o,L)=>(t(),d(e(X),{severity:"error",key:L},{default:h(()=>[P(a(o),1)]),_:2},1024))),128))]))}};export{fe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/PersonsUpsertForm-M0-zy1iQ.js","assets/index.esm-YLBYxjLo.js","assets/index-mqQjfPOb.js","assets/index-ZWerLMmy.css","assets/message.esm-m1pzN4mq.js","assets/index.esm-8WYIV_VM.js","assets/textarea.esm-thJ20K8f.js","assets/editor.esm-Tpg0OTQB.js","assets/AppPicturesSelector-zDtmrDxc.js","assets/AppTableSkeleton-i4JGvXbu.js","assets/fileupload.esm-IID_HbMp.js","assets/index.esm-u1puTXrG.js","assets/format-39s6QTMr.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
