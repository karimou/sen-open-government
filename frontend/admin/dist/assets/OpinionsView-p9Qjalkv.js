import{a as R,r as _,u as j,j as G,c as u,b as a,e as t,f as s,w as i,k as $,o as d,F as B,l as x,t as y,g as F,p as I,h as N,A as U,i as M,_ as D}from"./index-vwDixBhf.js";import{c as E,s as T,a as c,b as H}from"./toolbar.esm-IUUGoDwr.js";import{s as f}from"./inputtext.esm-odSb5XQY.js";import{u as L}from"./opinions-btLInoIu.js";import{_ as q}from"./_plugin-vue_export-helper-x3n3nnut.js";const g=m=>(I("data-v-94576972"),m=m(),N(),m),z={class:"grid"},J={class:"col-12"},K={key:0,class:"card"},Q={class:"my-2"},W={class:"p-float-label"},X=g(()=>a("label",null,"Grouper par:",-1)),Y=g(()=>a("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},[a("h5",{class:"m-0"},"Opinions")],-1)),Z=["alt","src"],P={class:"vertical-align-middle ml-2 font-bold line-height-3"},ee={key:1,class:"vertical-align-middle ml-2 font-bold line-height-3"},te={key:1,class:"px-4 py-5 shadow-1 flex flex-column md:flex-row md:align-items-center justify-content-between mb-3",style:{width:"600px","background-color":"white"}},oe=g(()=>a("div",null,[a("div",{class:"font-medium text-xl mt-2 mb-3"},"Aucune opinion"),a("div",{class:"font-medium"},"Cliquer sur le bouton suivant pour rajouter une première élection à la base de données")],-1)),se={class:"mt-4 mr-auto md:mt-0 md:mr-0"},ae={__name:"OpinionsView",setup(m){const p=L();R(p.refreshOpinions);const r=_(null),v=_(!1),k=()=>{var n;let o=(n=r.value)==null?void 0:n.map(h=>h.id);v.value=!0,U.opinions.deleteOpinions(o).then(()=>{p.refreshOpinions(),r.value=null}).finally(()=>v.value=!1)},O=j(),S=M(()=>D(()=>import("./OpinionsUpsertForm-jdL4DIUK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),b=(o={})=>{O.open(S,{data:o,onClose:p.refreshOpinions,props:{modal:!0}})},V=o=>`${o.firstname} ${o.lastname}`,C=G(()=>p.opinions.map(o=>({...o,author:{...o.author,name:V(o.author)}}))),w=_(),l=_("author.name"),A=[{field:"author.name",label:"Auteur"},{field:"issue.title",label:"Thème"}];return(o,n)=>{var h;return d(),u("div",z,[a("div",J,[((h=t(p).opinions)==null?void 0:h.length)>0?(d(),u("div",K,[s(t(T),{class:"mb-4"},{start:i(()=>[a("div",Q,[s(t(f),{label:"Ajouter une opinion",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:b}),s(t(f),{label:"Supprimer la sélection",icon:"pi pi-trash",class:"p-button-danger",onClick:k,disabled:!r.value||!r.value.length,loading:v.value},null,8,["disabled","loading"])])]),end:i(()=>[a("div",W,[s(t(E),{options:A,modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value=e),optionLabel:"label",optionValue:"field"},null,8,["modelValue"]),X])]),_:1}),(d(),$(t(H),{key:l.value,value:C.value,tableStyle:"min-width: 50rem",selection:r.value,"onUpdate:selection":n[1]||(n[1]=e=>r.value=e),expandedRowGroups:w.value,"onUpdate:expandedRowGroups":n[2]||(n[2]=e=>w.value=e),expandableRowGroups:"",rowGroupMode:"subheader",groupRowsBy:l.value,sortMode:"single",sortField:l.value,sortOrder:1},{header:i(()=>[Y]),groupheader:i(e=>[l.value=="author.name"?(d(),u(B,{key:0},[e.data.author.photo?(d(),u("img",{key:0,alt:e.data.author.name,src:e.data.author.photo,width:"32",style:{"vertical-align":"middle"},class:"ml-2"},null,8,Z)):x("",!0),a("span",P,y(e.data.author.name),1)],64)):l.value=="issue.title"?(d(),u("span",ee,y(e.data.issue.title),1)):x("",!0)]),default:i(()=>[s(t(c),{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(t(c),{headerStyle:"min-width: 100px"},{body:i(({data:e})=>[s(t(f),{class:"p-button-text p-button-rounded",icon:"pi pi-pencil",onClick:ne=>b(e)},null,8,["onClick"])]),_:1}),s(t(c),{field:"author.name",header:"Auteur"}),s(t(c),{field:"issue.title",header:"Sujet"}),s(t(c),{field:"summary",header:"Résumé"})]),_:1},8,["value","selection","expandedRowGroups","groupRowsBy","sortField"]))])):(d(),u("div",te,[oe,a("div",se,[s(t(f),{class:"p-button font-bold px-5 py-3 p-button-success p-button-rounded p-button-raised",onClick:b},{default:i(()=>[F("Ajouter")]),_:1})])]))])])}}},pe=q(ae,[["__scopeId","data-v-94576972"]]);export{pe as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/OpinionsUpsertForm-jdL4DIUK.js","assets/index.esm-Ul8tbHrw.js","assets/index-vwDixBhf.js","assets/index-tbN9M-MT.css","assets/inputtext.esm-odSb5XQY.js","assets/textarea.esm-JJfSMBS-.js","assets/editor.esm-yeS7qnU0.js","assets/toolbar.esm-IUUGoDwr.js","assets/message.esm-QJ3mL3J0.js","assets/persons-682ZcoEM.js","assets/issues-B92SDSdP.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
