import{r as V,X as N,o as R,a1 as U,A as j,u as D,a as t,c as l,b as r,f as o,e as u,w as h,E as i,V as g,g as k,F as P,n as q,h as T,i as M,_ as O}from"./index-sjrDLI-L.js";import{c as X,d as b,u as z,s as G}from"./message.esm-UrD84rNF.js";import{s as C}from"./index.esm-Kf8LRFWe.js";import{d as f}from"./AppTableSkeleton-Nfvta1m-.js";import{u as H}from"./persons-mFnoK_ll.js";import{u as J}from"./ElectionsView-ts0NWtGZ.js";const K={style:{width:"350px"}},Q=r("h5",null,"Ajouter un candidat",-1),W=["initial-values"],Y={class:"field"},Z=r("label",{for:"title"},"Candidat",-1),ee={key:0},oe={key:1},se={key:0},te={key:1},ae={class:"field"},ne=r("label",{for:"title"},"Élection",-1),_e={__name:"ElectionCandidateAdditionForm",setup(le){const S=X({electionId:b().required(),personId:b().required()}),{handleSubmit:A,errors:E,defineField:v,setFieldValue:I}=z({validationSchema:S}),[c,ie]=v("electionId"),[p,re]=v("personId"),a=H(),m=J(),w=V({}),d=N("dialogRef");R(()=>{d.value.data.electionId&&I("electionId",d.value.data.electionId),d.value.data.personId&&I("personId",d.value.data.personId),a.persons||a.refreshPersons(),m.elections||m.refreshElections()});const F=U(()=>{let n={};return a.persons.forEach(s=>n[s.id]=`${s.firstname} ${s.lastname}`),n}),_=V(!1),y=A(n=>{_.value=!0,j.elections.addElectionCandidate({electionId:c.value,personId:p.value}).then(s=>{d.value.close("success")}).finally(()=>_.value=!1)}),x=D(),$=M(()=>O(()=>import("./PersonsUpsertForm-I9N49c_T.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),B=(n={})=>{x.open($,{data:n,onClose:s=>{(s==null?void 0:s.data)=="success"&&a.refreshPersons()},props:{modal:!0}})};return(n,s)=>(t(),l("div",K,[Q,r("form",{onSubmit:s[2]||(s[2]=(...e)=>o(y)&&o(y)(...e)),"initial-values":w.value.value},[r("div",Y,[Z,o(a).persons?(t(),u(o(f),{key:1,modelValue:o(p),"onUpdate:modelValue":s[0]||(s[0]=e=>g(p)?p.value=e:null),options:o(a).persons,optionLabel:"firstname",optionValue:"id",placeholder:"Choisir une personne",class:"w-full",filter:""},{value:h(e=>[e.value?(t(),l("span",ee,i(F.value[e.value]),1)):(t(),l("span",oe,i(e.placeholder),1))]),option:h(e=>[e.option?(t(),l("span",se,i(e.option.firstname)+" "+i(e.option.lastname),1)):(t(),l("span",te,i(e.placeholder),1))]),_:1},8,["modelValue","options"])):(t(),u(o(f),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"})),k(o(C),{label:"Ajouter une personne",icon:"pi pi-plus",text:"",onClick:B})]),r("div",ae,[ne,o(m).elections?(t(),u(o(f),{key:1,modelValue:o(c),"onUpdate:modelValue":s[1]||(s[1]=e=>g(c)?c.value=e:null),options:o(m).elections,optionLabel:"title",optionValue:"id",placeholder:"Choisir une élection",class:"w-full",filter:""},null,8,["modelValue","options"])):(t(),u(o(f),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"}))]),k(o(C),{type:"submit",label:"Soumettre",class:"w-full",loading:_.value},null,8,["loading"])],40,W),(t(!0),l(P,null,q(o(E),(e,L)=>(t(),u(o(G),{severity:"error",key:L},{default:h(()=>[T(i(e),1)]),_:2},1024))),128))]))}};export{_e as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/PersonsUpsertForm-I9N49c_T.js","assets/message.esm-UrD84rNF.js","assets/index-sjrDLI-L.js","assets/index-D9x--RlZ.css","assets/index.esm-Kf8LRFWe.js","assets/textarea.esm-EobiClLN.js","assets/editor.esm-H7fnoAox.js","assets/AppTableSkeleton-Nfvta1m-.js","assets/index.esm-oP_jV4I_.js","assets/format-39s6QTMr.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
