import{c as N,a as o,b as R,u as D,s as E}from"./message.esm-OieoKZiQ.js";import{b as r,s as j}from"./index.esm-FaUUA4nG.js";import{s as q}from"./textarea.esm-WoudxIoE.js";import"./editor.esm-kVSwRZPD.js";import{r as y,X as I,a as T,A as U,o as k,c as F,b as s,E as S,g as i,f as l,V as d,F as z,n as C,e as L,w as W,h as X}from"./index-HWtTsvFM.js";import{f as G}from"./format-39s6QTMr.js";const H={style:{width:"450px"}},J=["initial-values"],K={class:"formgrid grid"},O={class:"field col-6"},Q=s("label",{for:"firstname"},"PrÃ©nom",-1),Y={class:"field col-6"},Z=s("label",{for:"title"},"Nom",-1),ee={class:"formgrid grid"},te={class:"field col-6"},le=s("label",{for:"date_of_birth"},"Date de naissance",-1),se={class:"field"},ae=s("label",{for:"description"},"Description",-1),oe={class:"formgrid grid"},ie={class:"field col-6"},de=s("label",{for:"title"},"Website",-1),ne={class:"field col-6"},re=s("label",{for:"title"},"Facebook",-1),ue={class:"field col-6"},fe=s("label",{for:"title"},"Twitter",-1),ce={class:"field col-6"},me=s("label",{for:"title"},"Instagram",-1),$e={__name:"PersonsUpsertForm",setup(_e){const $=N({firstname:o().required(),lastname:o().required(),gender:o(),date_of_birth:R(),description:o(),website:o(),facebook:o(),twitter:o(),instagram:o(),photo:o()}),{handleSubmit:P,errors:B,defineField:a,setFieldValue:A}=D({validationSchema:$}),[_,pe]=a("firstname"),[p,ve]=a("lastname");a("gender");const[v,be]=a("date_of_birth"),[b,Ve]=a("description"),[V,he]=a("twitter"),[h,we]=a("facebook"),[w,ge]=a("instagram"),[g,ye]=a("website");a("photo");const c=y(null),M=y({}),n=I("dialogRef");T(()=>{var u,e,t;(u=n.value.data)!=null&&u.date_of_birth&&A("date_of_birth",G((e=n.value.date_of_birth)==null?void 0:e.date,"yyyy-MM-dd")),["firstname","lastname","gender","description","facebook","instagram","twitter","website","photo"].forEach(f=>{n.value.data[f]&&A(f,n.value.data[f])}),c.value=(t=n.value.data)==null?void 0:t.id});const m=y(!1),x=P(u=>{m.value=!0,c.value?U.persons.updatePerson({...u,id:c.value}).then(e=>{n.value.close("success")}).finally(()=>m.value=!1):U.persons.addPerson(u).then(e=>{n.value.close("success")}).finally(()=>m.value=!1)});return(u,e)=>(k(),F("div",H,[s("h5",null,S(c.value?"Modifier":"Ajouter")+" une personne",1),s("form",{onSubmit:e[8]||(e[8]=(...t)=>l(x)&&l(x)(...t)),"initial-values":M.value.value},[s("div",K,[s("div",O,[Q,i(l(r),{id:"firstname",type:"text",modelValue:l(_),"onUpdate:modelValue":e[0]||(e[0]=t=>d(_)?_.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",Y,[Z,i(l(r),{id:"lastname",type:"text",modelValue:l(p),"onUpdate:modelValue":e[1]||(e[1]=t=>d(p)?p.value=t:null),class:"w-full"},null,8,["modelValue"])])]),s("div",ee,[s("div",te,[le,i(l(r),{id:"date_of_birth",type:"date",modelValue:l(v),"onUpdate:modelValue":e[2]||(e[2]=t=>d(v)?v.value=t:null),class:"w-full"},null,8,["modelValue"])])]),s("div",se,[ae,i(l(q),{id:"description",modelValue:l(b),"onUpdate:modelValue":e[3]||(e[3]=t=>d(b)?b.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),s("div",oe,[s("div",ie,[de,i(l(r),{id:"website",type:"url",modelValue:l(g),"onUpdate:modelValue":e[4]||(e[4]=t=>d(g)?g.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",ne,[re,i(l(r),{id:"facebook",type:"text",modelValue:l(h),"onUpdate:modelValue":e[5]||(e[5]=t=>d(h)?h.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",ue,[fe,i(l(r),{id:"twitter",type:"text",modelValue:l(V),"onUpdate:modelValue":e[6]||(e[6]=t=>d(V)?V.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",ce,[me,i(l(r),{id:"instagram",type:"text",modelValue:l(w),"onUpdate:modelValue":e[7]||(e[7]=t=>d(w)?w.value=t:null),class:"w-full"},null,8,["modelValue"])])]),i(l(j),{type:"submit",label:"Soumettre",class:"w-full",loading:m.value},null,8,["loading"])],40,J),(k(!0),F(z,null,C(l(B),(t,f)=>(k(),L(l(E),{severity:"error",key:f},{default:W(()=>[X(S(t),1)]),_:2},1024))),128))]))}};export{$e as default};
