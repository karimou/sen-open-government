import{c as R,a as i,b as D,u as E,s as j}from"./message.esm-O7AaV-cU.js";import{b as u,s as q}from"./index.esm-_HLybhMr.js";import{s as I}from"./textarea.esm-u5kzhW9E.js";import"./editor.esm-VSH3uCym.js";import{r as A,X as T,o as z,A as F,a as k,c as $,b as s,E as S,g as a,f as l,V as n,F as C,n as L,e as W,w as X,h as G}from"./index-R5AkUM7P.js";import{_ as H}from"./AppPicturesSelector-na_9qJIo.js";import{f as J}from"./format-39s6QTMr.js";import"./AppTableSkeleton-a1Gw-PO_.js";import"./index.esm-47E1heZh.js";const K={style:{width:"450px"}},O=["initial-values"],Q={class:"formgrid grid"},Y={class:"field col-6"},Z=s("label",{for:"firstname"},"PrÃ©nom",-1),ee={class:"field col-6"},te=s("label",{for:"title"},"Nom",-1),le={class:"formgrid grid"},se={class:"field col-6"},oe=s("label",{for:"date_of_birth"},"Date de naissance",-1),ae={class:"field"},ie=s("label",{for:"description"},"Description",-1),ne={class:"formgrid grid"},re={class:"field col-6"},de=s("label",{for:"title"},"Website",-1),ue={class:"field col-6"},me=s("label",{for:"title"},"Facebook",-1),fe={class:"field col-6"},ce=s("label",{for:"title"},"Twitter",-1),_e={class:"field col-6"},pe=s("label",{for:"title"},"Instagram",-1),De={__name:"PersonsUpsertForm",setup(ve){const P=R({firstname:i().required(),lastname:i().required(),gender:i(),date_of_birth:D(),description:i(),website:i(),facebook:i(),twitter:i(),instagram:i(),photo:i()}),{handleSubmit:B,errors:M,defineField:o,setFieldValue:x}=E({validationSchema:P}),[_,be]=o("firstname"),[p,Ve]=o("lastname");o("gender");const[v,ge]=o("date_of_birth"),[b,he]=o("description"),[V,we]=o("twitter"),[g,ye]=o("facebook"),[h,Ae]=o("instagram"),[w,ke]=o("website"),[y,xe]=o("photo"),f=A(null),N=A({}),r=T("dialogRef");z(()=>{var d,e,t;(d=r.value.data)!=null&&d.date_of_birth&&x("date_of_birth",J((e=r.value.date_of_birth)==null?void 0:e.date,"yyyy-MM-dd")),["firstname","lastname","gender","description","facebook","instagram","twitter","website","photo"].forEach(m=>{r.value.data[m]&&x(m,r.value.data[m])}),f.value=(t=r.value.data)==null?void 0:t.id});const c=A(!1),U=B(d=>{c.value=!0,console.log(d),f.value?F.persons.updatePerson({...d,id:f.value}).then(e=>{r.value.close("success")}).finally(()=>c.value=!1):F.persons.addPerson(d).then(e=>{r.value.close("success")}).finally(()=>c.value=!1)});return(d,e)=>(k(),$("div",K,[s("h5",null,S(f.value?"Modifier":"Ajouter")+" une personne",1),s("form",{onSubmit:e[9]||(e[9]=(...t)=>l(U)&&l(U)(...t)),"initial-values":N.value.value},[a(H,{image:l(y),"onUpdate:image":e[0]||(e[0]=t=>n(y)?y.value=t:null)},null,8,["image"]),s("div",Q,[s("div",Y,[Z,a(l(u),{id:"firstname",type:"text",modelValue:l(_),"onUpdate:modelValue":e[1]||(e[1]=t=>n(_)?_.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",ee,[te,a(l(u),{id:"lastname",type:"text",modelValue:l(p),"onUpdate:modelValue":e[2]||(e[2]=t=>n(p)?p.value=t:null),class:"w-full"},null,8,["modelValue"])])]),s("div",le,[s("div",se,[oe,a(l(u),{id:"date_of_birth",type:"date",modelValue:l(v),"onUpdate:modelValue":e[3]||(e[3]=t=>n(v)?v.value=t:null),class:"w-full"},null,8,["modelValue"])])]),s("div",ae,[ie,a(l(I),{id:"description",modelValue:l(b),"onUpdate:modelValue":e[4]||(e[4]=t=>n(b)?b.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),s("div",ne,[s("div",re,[de,a(l(u),{id:"website",type:"url",modelValue:l(w),"onUpdate:modelValue":e[5]||(e[5]=t=>n(w)?w.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",ue,[me,a(l(u),{id:"facebook",type:"text",modelValue:l(g),"onUpdate:modelValue":e[6]||(e[6]=t=>n(g)?g.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",fe,[ce,a(l(u),{id:"twitter",type:"text",modelValue:l(V),"onUpdate:modelValue":e[7]||(e[7]=t=>n(V)?V.value=t:null),class:"w-full"},null,8,["modelValue"])]),s("div",_e,[pe,a(l(u),{id:"instagram",type:"text",modelValue:l(h),"onUpdate:modelValue":e[8]||(e[8]=t=>n(h)?h.value=t:null),class:"w-full"},null,8,["modelValue"])])]),a(l(q),{type:"submit",label:"Soumettre",class:"w-full",loading:c.value},null,8,["loading"])],40,O),(k(!0),$(C,null,L(l(M),(t,m)=>(k(),W(l(j),{severity:"error",key:m},{default:X(()=>[G(S(t),1)]),_:2},1024))),128))]))}};export{De as default};
