import{c as k,a as d,u as U}from"./index.esm-P-gXdjAE.js";import{b as B,s as I}from"./index.esm-vgsyuL-8.js";import{s as R}from"./textarea.esm-vCzr1SR7.js";import{s as q}from"./editor.esm-y9cAV494.js";import{s as D}from"./message.esm-er91D30t.js";import{r as v,Y as N,o as j,A as V,a as h,c as b,b as o,k as y,g as a,f as t,W as c,F as E,p as M,e as T,w as z,h as C}from"./index-jfYll-nw.js";import{_ as L}from"./AppPicturesSelector-rmKZ8n4L.js";import"./AppTableSkeleton-fANpGBpA.js";import"./fileupload.esm-a_DNqsbQ.js";import"./index.esm-N1Oc4E2N.js";const P={style:{width:"650px"}},W=["initial-values"],Y={class:"field"},G=o("label",{for:"title"},"Titre",-1),H={class:"field"},J=o("label",{for:"short_description"},"Description courte",-1),K={class:"field"},O=o("label",{for:"short_description"},"Description longue",-1),pe={__name:"IssuesUpsertForm",setup(Q){const x=k({title:d().required(),short_description:d().required(),long_description:d(),photo:d()}),{handleSubmit:A,errors:S,defineField:r,setFieldValue:$}=U({validationSchema:x}),[p,X]=r("title"),[m,Z]=r("short_description"),[_,ee]=r("long_description"),[f,te]=r("photo"),n=v(null),w=v({}),i=N("dialogRef");j(()=>{var l;["title","short_description","long_description","photo"].forEach(e=>{i.value.data[e]&&$(e,i.value.data[e])}),n.value=(l=i.value.data)==null?void 0:l.id});const u=v(!1),g=A(l=>{u.value=!0,n.value?V.issues.updateIssue({...l,id:n.value}).then(e=>{i.value.close("success")}).finally(()=>u.value=!1):V.issues.addIssue(l).then(e=>{i.value.close("success")}).finally(()=>u.value=!1)});return(l,e)=>(h(),b("div",P,[o("h5",null,y(n.value?"Modifier":"Ajouter")+" un thÃ¨me politique",1),o("form",{onSubmit:e[4]||(e[4]=(...s)=>t(g)&&t(g)(...s)),"initial-values":w.value.value},[a(L,{image:t(f),"onUpdate:image":e[0]||(e[0]=s=>c(f)?f.value=s:null)},null,8,["image"]),o("div",Y,[G,a(t(B),{id:"title",type:"text",modelValue:t(p),"onUpdate:modelValue":e[1]||(e[1]=s=>c(p)?p.value=s:null),class:"w-full"},null,8,["modelValue"])]),o("div",H,[J,a(t(R),{id:"short_description",modelValue:t(m),"onUpdate:modelValue":e[2]||(e[2]=s=>c(m)?m.value=s:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),o("div",K,[O,a(t(q),{modelValue:t(_),"onUpdate:modelValue":e[3]||(e[3]=s=>c(_)?_.value=s:null),id:"long_description",editorStyle:"height: 320px"},null,8,["modelValue"])]),a(t(I),{type:"submit",label:"Soumettre",class:"w-full",loading:u.value},null,8,["loading"])],40,W),(h(!0),b(E,null,M(t(S),(s,F)=>(h(),T(t(D),{severity:"error",key:F},{default:z(()=>[C(y(s),1)]),_:2},1024))),128))]))}};export{pe as default};
