import{c as k,a as r,u as R}from"./index.esm-P-gXdjAE.js";import{b as U,s as B}from"./index.esm-vgsyuL-8.js";import{s as D}from"./textarea.esm-vCzr1SR7.js";import{s as q}from"./editor.esm-y9cAV494.js";import{s as N}from"./message.esm-er91D30t.js";import{r as d,Y as j,o as C,A as h,a as y,c as b,b as a,k as x,g as i,f as l,W as c,F as E,p as I,e as M,w as T,h as z}from"./index-jfYll-nw.js";import{_ as L}from"./AppPicturesSelector-rmKZ8n4L.js";import"./AppTableSkeleton-fANpGBpA.js";import"./fileupload.esm-a_DNqsbQ.js";import"./index.esm-N1Oc4E2N.js";const W={style:{width:"650px"}},Y=["initial-values"],G={class:"field"},H=a("label",{for:"title"},"Titre",-1),J={class:"field"},K=a("label",{for:"summary"},"Résumé",-1),O={class:"field"},Q=a("label",{for:"summary"},"Contenu",-1),pe={__name:"DocumentPagesUpsertForm",setup(X){const A=k({title:r().required(),summary:r().required(),content:r(),cover_image_url:r(),capsule_url:r()}),{handleSubmit:S,errors:$,defineField:u,setFieldValue:w}=R({validationSchema:A}),[p,Z]=u("title"),[_,ee]=u("summary"),[f,te]=u("content"),[v,le]=u("cover_image_url");u("capsule_url");const n=d(null),g=d(null),F=d({}),s=j("dialogRef");C(()=>{var o,e;["title","summary","content","cover_image_url","caspsule_ref"].forEach(t=>{s.value.data[t]&&w(t,s.value.data[t])}),n.value=(o=s.value.data)==null?void 0:o.id,g.value=(e=s.value.data)==null?void 0:e.parent_id});const m=d(!1),V=S(o=>{m.value=!0,n.value?h.documentPages.updateDocumentPage({...o,id:n.value,parent_id:g.value}).then(e=>{s.value.close("success")}).finally(()=>m.value=!1):h.documentPages.addDocumentPage({...o,parent_id:g.value}).then(e=>{s.value.close("success")}).finally(()=>m.value=!1)});return(o,e)=>(y(),b("div",W,[a("h5",null,x(n.value?"Modifier":"Ajouter")+" un thème politique",1),a("form",{onSubmit:e[4]||(e[4]=(...t)=>l(V)&&l(V)(...t)),"initial-values":F.value.value},[i(L,{image:l(v),"onUpdate:image":e[0]||(e[0]=t=>c(v)?v.value=t:null)},null,8,["image"]),a("div",G,[H,i(l(U),{id:"title",type:"text",modelValue:l(p),"onUpdate:modelValue":e[1]||(e[1]=t=>c(p)?p.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",J,[K,i(l(D),{id:"summary",modelValue:l(_),"onUpdate:modelValue":e[2]||(e[2]=t=>c(_)?_.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),a("div",O,[Q,i(l(q),{modelValue:l(f),"onUpdate:modelValue":e[3]||(e[3]=t=>c(f)?f.value=t:null),id:"content",editorStyle:"height: 320px"},null,8,["modelValue"])]),i(l(B),{type:"submit",label:"Soumettre",class:"w-full",loading:m.value},null,8,["loading"])],40,Y),(y(!0),b(E,null,I(l($),(t,P)=>(y(),M(l(N),{severity:"error",key:P},{default:T(()=>[z(x(t),1)]),_:2},1024))),128))]))}};export{pe as default};
