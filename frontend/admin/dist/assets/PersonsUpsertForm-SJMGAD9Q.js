import{c as E,a as n,b as j,u as q,s as I}from"./message.esm-R2931qIK.js";import{b as r,s as T}from"./index.esm-gdRg23pp.js";import{s as z}from"./textarea.esm-DaVE8NbD.js";import"./editor.esm-li_xWJSK.js";import{r as k,X as C,o as L,A as S,a as U,c as $,b as o,E as P,g as a,f as l,V as d,F as W,n as X,e as G,w as H,h as J}from"./index-D7X0WbD9.js";import{_ as K}from"./AppPicturesSelector-Yyfn3RCI.js";import{f as O}from"./format-39s6QTMr.js";import"./AppTableSkeleton-F_Hh2g5g.js";import"./index.esm-sdiyZ5of.js";const Q={style:{width:"450px"}},Y=["initial-values"],Z={class:"formgrid grid"},ee={class:"field col-6"},te=o("label",{for:"firstname"},"PrÃ©nom",-1),le={class:"field col-6"},oe=o("label",{for:"title"},"Nom",-1),se={class:"formgrid grid"},ae={class:"field col-6"},ie=o("label",{for:"date_of_birth"},"Date de naissance",-1),ne={class:"field col-6"},de=o("label",{for:"occupation"},"Profession",-1),re={class:"field"},ue=o("label",{for:"description"},"Description",-1),ce={class:"formgrid grid"},me={class:"field col-6"},fe=o("label",{for:"title"},"Website",-1),_e={class:"field col-6"},pe=o("label",{for:"title"},"Facebook",-1),ve={class:"field col-6"},be=o("label",{for:"title"},"Twitter",-1),Ve={class:"field col-6"},ge=o("label",{for:"title"},"Instagram",-1),Te={__name:"PersonsUpsertForm",setup(he){const B=E({firstname:n().required(),lastname:n().required(),gender:n(),date_of_birth:j(),occupation:n(),description:n(),website:n(),facebook:n(),twitter:n(),instagram:n(),photo:n()}),{handleSubmit:D,errors:M,defineField:s,setFieldValue:x}=q({validationSchema:B}),[_,we]=s("firstname"),[p,ye]=s("lastname");s("gender");const[v,Ae]=s("date_of_birth"),[b,ke]=s("description"),[V,Ue]=s("occupation"),[g,xe]=s("twitter"),[h,Fe]=s("facebook"),[w,Se]=s("instagram"),[y,$e]=s("website"),[A,Pe]=s("photo"),m=k(null),N=k({}),u=C("dialogRef");L(()=>{var c,e,t;if((c=u.value.data)!=null&&c.date_of_birth)try{let i=(e=u.value.date_of_birth)==null?void 0:e.date;console.log(i);let R=new Date(i);x("date_of_birth",O(R,"yyyy-MM-dd"))}catch(i){console.log(i)}["firstname","lastname","gender","occupation","description","facebook","instagram","twitter","website","photo"].forEach(i=>{u.value.data[i]&&x(i,u.value.data[i])}),m.value=(t=u.value.data)==null?void 0:t.id});const f=k(!1),F=D(c=>{f.value=!0,m.value?S.persons.updatePerson({...c,id:m.value}).then(e=>{u.value.close("success")}).finally(()=>f.value=!1):S.persons.addPerson(c).then(e=>{u.value.close("success")}).finally(()=>f.value=!1)});return(c,e)=>(U(),$("div",Q,[o("h5",null,P(m.value?"Modifier":"Ajouter")+" une personne",1),o("form",{onSubmit:e[10]||(e[10]=(...t)=>l(F)&&l(F)(...t)),"initial-values":N.value.value},[a(K,{image:l(A),"onUpdate:image":e[0]||(e[0]=t=>d(A)?A.value=t:null)},null,8,["image"]),o("div",Z,[o("div",ee,[te,a(l(r),{id:"firstname",type:"text",modelValue:l(_),"onUpdate:modelValue":e[1]||(e[1]=t=>d(_)?_.value=t:null),class:"w-full"},null,8,["modelValue"])]),o("div",le,[oe,a(l(r),{id:"lastname",type:"text",modelValue:l(p),"onUpdate:modelValue":e[2]||(e[2]=t=>d(p)?p.value=t:null),class:"w-full"},null,8,["modelValue"])])]),o("div",se,[o("div",ae,[ie,a(l(r),{id:"date_of_birth",type:"date",modelValue:l(v),"onUpdate:modelValue":e[3]||(e[3]=t=>d(v)?v.value=t:null),class:"w-full"},null,8,["modelValue"])]),o("div",ne,[de,a(l(r),{id:"occupation",modelValue:l(V),"onUpdate:modelValue":e[4]||(e[4]=t=>d(V)?V.value=t:null),class:"w-full"},null,8,["modelValue"])])]),o("div",re,[ue,a(l(z),{id:"description",modelValue:l(b),"onUpdate:modelValue":e[5]||(e[5]=t=>d(b)?b.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),o("div",ce,[o("div",me,[fe,a(l(r),{id:"website",type:"url",modelValue:l(y),"onUpdate:modelValue":e[6]||(e[6]=t=>d(y)?y.value=t:null),class:"w-full"},null,8,["modelValue"])]),o("div",_e,[pe,a(l(r),{id:"facebook",type:"text",modelValue:l(h),"onUpdate:modelValue":e[7]||(e[7]=t=>d(h)?h.value=t:null),class:"w-full"},null,8,["modelValue"])]),o("div",ve,[be,a(l(r),{id:"twitter",type:"text",modelValue:l(g),"onUpdate:modelValue":e[8]||(e[8]=t=>d(g)?g.value=t:null),class:"w-full"},null,8,["modelValue"])]),o("div",Ve,[ge,a(l(r),{id:"instagram",type:"text",modelValue:l(w),"onUpdate:modelValue":e[9]||(e[9]=t=>d(w)?w.value=t:null),class:"w-full"},null,8,["modelValue"])])]),a(l(T),{type:"submit",label:"Soumettre",class:"w-full",loading:f.value},null,8,["loading"])],40,Y),(U(!0),$(W,null,X(l(M),(t,i)=>(U(),G(l(I),{severity:"error",key:i},{default:H(()=>[J(P(t),1)]),_:2},1024))),128))]))}};export{Te as default};
