import{c as M,b as R,a as V,u as q}from"./index.esm-v6cDy30M.js";import{b as A,s as D}from"./index.esm-BEizDpwn.js";import{s as N}from"./textarea.esm-36WrxFgm.js";import{s as $}from"./radiobutton.esm-gGkjbE1N.js";import{s as j}from"./message.esm-43B1DmQ7.js";import{r as b,Y as L,o as P,A as k,a as h,c as x,b as a,k as F,g as d,f as l,W as n,F as T,p as z,e as C,w as I,h as W}from"./index-om2yVH6z.js";import{f as Y}from"./format-39s6QTMr.js";const G={style:{width:"450px"}},H=["initial-values"],J={class:"field"},K={class:"field-radiobutton"},O=a("label",{for:"type1"},"Présidentielle",-1),Q={class:"field-radiobutton"},X=a("label",{for:"type2"},"Législatives",-1),Z={class:"field"},ee=a("label",{for:"title"},"Titre",-1),te={class:"field"},le=a("label",{for:"date"},"Date",-1),ae={class:"field"},se=a("label",{for:"description"},"Description",-1),ye={__name:"ElectionsUpsertForm",setup(ie){const S=M({date:R().required(),title:V().required(),type:V().required(),description:V()}),{handleSubmit:U,errors:E,defineField:r,setFieldValue:m}=q({validationSchema:S}),[f,oe]=r("date"),[v,de]=r("title"),[i,ne]=r("type"),[_,re]=r("description"),u=b(null),B=b({}),s=L("dialogRef");P(()=>{var o,e,t,p,w;(o=s.value.data)!=null&&o.date&&m("date",Y((e=s.value.data)==null?void 0:e.date,"yyyy-MM-dd")),m("type",((t=s.value.data)==null?void 0:t.type)=="click"?"presidential":(p=s.value.data)==null?void 0:p.type),["title","description"].forEach(y=>{s.value.data[y]&&m(y,s.value.data[y])}),u.value=(w=s.value.data)==null?void 0:w.id});const c=b(!1),g=U(o=>{c.value=!0,u.value?k.elections.updateElection({...o,id:u.value}).then(e=>{s.value.close("success")}).finally(()=>c.value=!1):k.elections.addElection(o).then(e=>{s.value.close("success")}).finally(()=>c.value=!1)});return(o,e)=>(h(),x("div",G,[a("h5",null,F(u.value?"Modifier":"Ajouter")+" une élection",1),a("form",{onSubmit:e[5]||(e[5]=(...t)=>l(g)&&l(g)(...t)),"initial-values":B.value.value},[a("div",J,[a("div",K,[d(l($),{id:"type1",name:"type",modelValue:l(i),"onUpdate:modelValue":e[0]||(e[0]=t=>n(i)?i.value=t:null),value:"presidential"},null,8,["modelValue"]),O]),a("div",Q,[d(l($),{id:"type2",name:"type",modelValue:l(i),"onUpdate:modelValue":e[1]||(e[1]=t=>n(i)?i.value=t:null),value:"parliament"},null,8,["modelValue"]),X])]),a("div",Z,[ee,d(l(A),{id:"title",type:"text",modelValue:l(v),"onUpdate:modelValue":e[2]||(e[2]=t=>n(v)?v.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",te,[le,d(l(A),{id:"date",type:"date",modelValue:l(f),"onUpdate:modelValue":e[3]||(e[3]=t=>n(f)?f.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",ae,[se,d(l(N),{id:"description",modelValue:l(_),"onUpdate:modelValue":e[4]||(e[4]=t=>n(_)?_.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),d(l(D),{type:"submit",label:"Soumettre",class:"w-full",loading:c.value},null,8,["loading"])],40,H),(h(!0),x(T,null,z(l(E),(t,p)=>(h(),C(l(j),{severity:"error",key:p},{default:I(()=>[W(F(t),1)]),_:2},1024))),128))]))}};export{ye as default};
