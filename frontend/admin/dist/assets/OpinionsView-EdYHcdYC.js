import{r as c,a as S,u as $,j,c as u,b as a,e as y,f as t,g as s,w as d,o as l,F as G,k as w,t as x,h as B,A as F,i as N,_ as U}from"./index-SBcS5hmR.js";import{c as M,s as D,a as m,b as E,_ as L}from"./AppTableSkeleton-rJ52jCtG.js";import{s as f}from"./index.esm-2ozWNLcu.js";import{u as T}from"./opinions-_G2g8Q6Y.js";const H={class:"grid"},I={class:"col-12"},q={key:1,class:"card"},z={class:"my-2"},J={class:"p-float-label"},K=a("label",null,"Grouper par:",-1),Q=a("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},[a("h5",{class:"m-0"},"Opinions")],-1),W=["alt","src"],X={class:"vertical-align-middle ml-2 font-bold line-height-3"},Y={key:1,class:"vertical-align-middle ml-2 font-bold line-height-3"},Z={key:2,class:"px-4 py-5 shadow-1 flex flex-column md:flex-row md:align-items-center justify-content-between mb-3",style:{width:"600px","background-color":"white"}},P=a("div",null,[a("div",{class:"font-medium text-xl mt-2 mb-3"},"Aucune opinion"),a("div",{class:"font-medium"},"Cliquer sur le bouton suivant pour rajouter une première opinion à la base de données")],-1),ee={class:"mt-4 mr-auto md:mt-0 md:mr-0"},ie={__name:"OpinionsView",setup(te){const _=c(!1),p=T();S(()=>{_.value=!0,p.refreshOpinions().then(()=>_.value=!1)});const r=c(null),v=c(!1),k=()=>{var n;let o=(n=r.value)==null?void 0:n.map(h=>h.id);v.value=!0,F.opinions.deleteOpinions(o).then(()=>{p.refreshOpinions(),r.value=null}).finally(()=>v.value=!1)},O=$(),C=N(()=>U(()=>import("./OpinionsUpsertForm-ResJ51O0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),b=(o={})=>{O.open(C,{data:o,onClose:p.refreshOpinions,props:{modal:!0}})},V=o=>`${o.firstname} ${o.lastname}`,A=j(()=>p.opinions.map(o=>({...o,author:{...o.author,name:V(o.author)}}))),g=c(),i=c("author.name"),R=[{field:"author.name",label:"Auteur"},{field:"issue.title",label:"Thème"}];return(o,n)=>{var h;return l(),u("div",H,[a("div",I,[_.value?(l(),y(L,{key:0})):((h=t(p).opinions)==null?void 0:h.length)>0?(l(),u("div",q,[s(t(D),{class:"mb-4"},{start:d(()=>[a("div",z,[s(t(f),{label:"Ajouter une opinion",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:b}),s(t(f),{label:"Supprimer la sélection",icon:"pi pi-trash",class:"p-button-danger",onClick:k,disabled:!r.value||!r.value.length,loading:v.value},null,8,["disabled","loading"])])]),end:d(()=>[a("div",J,[s(t(M),{options:R,modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),optionLabel:"label",optionValue:"field"},null,8,["modelValue"]),K])]),_:1}),(l(),y(t(E),{key:i.value,value:A.value,tableStyle:"min-width: 50rem",selection:r.value,"onUpdate:selection":n[1]||(n[1]=e=>r.value=e),expandedRowGroups:g.value,"onUpdate:expandedRowGroups":n[2]||(n[2]=e=>g.value=e),expandableRowGroups:"",rowGroupMode:"subheader",groupRowsBy:i.value,sortMode:"single",sortField:i.value,sortOrder:1},{header:d(()=>[Q]),groupheader:d(e=>[i.value=="author.name"?(l(),u(G,{key:0},[e.data.author.photo?(l(),u("img",{key:0,alt:e.data.author.name,src:e.data.author.photo,width:"32",style:{"vertical-align":"middle"},class:"ml-2"},null,8,W)):w("",!0),a("span",X,x(e.data.author.name),1)],64)):i.value=="issue.title"?(l(),u("span",Y,x(e.data.issue.title),1)):w("",!0)]),default:d(()=>[s(t(m),{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(t(m),{headerStyle:"min-width: 100px"},{body:d(({data:e})=>[s(t(f),{class:"p-button-text p-button-rounded",icon:"pi pi-pencil",onClick:oe=>b(e)},null,8,["onClick"])]),_:1}),s(t(m),{field:"author.name",header:"Auteur"}),s(t(m),{field:"issue.title",header:"Sujet"}),s(t(m),{field:"summary",header:"Résumé"})]),_:1},8,["value","selection","expandedRowGroups","groupRowsBy","sortField"]))])):(l(),u("div",Z,[P,a("div",ee,[s(t(f),{class:"p-button font-bold px-5 py-3 p-button-success p-button-rounded p-button-raised",onClick:b},{default:d(()=>[B("Ajouter")]),_:1})])]))])])}}};export{ie as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/OpinionsUpsertForm-ResJ51O0.js","assets/index-SBcS5hmR.js","assets/index-tbN9M-MT.css","assets/message.esm-Z2CAW3Ck.js","assets/index.esm-2ozWNLcu.js","assets/textarea.esm-Z8MDRICx.js","assets/editor.esm-R1dHfCbt.js","assets/AppTableSkeleton-rJ52jCtG.js","assets/persons-1Dg7K20i.js","assets/issues-hmYFKxmx.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
