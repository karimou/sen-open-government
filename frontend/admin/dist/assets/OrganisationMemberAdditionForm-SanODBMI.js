import{r as k,Y as B,o as L,A as M,u as N,a,c as i,b as t,f as e,e as d,w as I,k as r,W as b,g as V,F as j,p as D,h as E,i as P,_ as q}from"./index-om2yVH6z.js";import{c as T,d as A,a as W,u as Y}from"./index.esm-v6cDy30M.js";import{s as S,b as z}from"./index.esm-BEizDpwn.js";import{c as f}from"./AppTableSkeleton-bFD8jdFV.js";import{s as G}from"./message.esm-43B1DmQ7.js";import{u as H}from"./persons-Q5GhyaGj.js";import{u as J}from"./OrganisationsView-3RzJjriP.js";const K={style:{width:"350px"}},Q=t("h5",null,"Ajouter un membre",-1),X=["initial-values"],Z={class:"field"},ee=t("label",{for:"title"},"Membre",-1),oe={key:0},se={key:1},ae={key:0},te={key:1},ne={class:"field"},le=t("label",{for:"title"},"Organisation",-1),ie={class:"field"},re=t("label",{for:"role"},"Role",-1),be={__name:"OrganisationMemberAdditionForm",setup(de){const w=T({organisationId:A().required(),personId:A().required(),role:W()}),{handleSubmit:C,errors:F,defineField:_,setFieldValue:g}=Y({validationSchema:w}),[u,ue]=_("organisationId"),[c,ce]=_("personId"),[p,pe]=_("role"),l=H(),m=J(),x=k({}),n=B("dialogRef");L(()=>{n.value.data.organisationId&&g("organisationId",n.value.data.organisationId),n.value.data.personId&&g("personId",n.value.data.personId),n.value.data.role&&g("personId",n.value.data.role),l.persons||l.refreshPersons(),m.organisations||m.refreshOrganisations()});const v=k(!1),y=C(h=>{v.value=!0,M.organisations.addOrganisationMember({organisationId:u.value,personId:c.value,role:p.value}).then(s=>{n.value.close("success")}).finally(()=>v.value=!1)}),O=N(),$=P(()=>q(()=>import("./PersonsUpsertForm-QfBQsrWN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),R=(h={})=>{O.open($,{data:h,onClose:s=>{(s==null?void 0:s.data)=="success"&&l.refreshPersons()},props:{modal:!0}})};return(h,s)=>(a(),i("div",K,[Q,t("form",{onSubmit:s[3]||(s[3]=(...o)=>e(y)&&e(y)(...o)),"initial-values":x.value.value},[t("div",Z,[ee,e(l).persons?(a(),d(e(f),{key:1,modelValue:e(c),"onUpdate:modelValue":s[0]||(s[0]=o=>b(c)?c.value=o:null),options:e(l).persons,optionLabel:"firstname",optionValue:"id",placeholder:"Choisir une personne",class:"w-full",filter:""},{value:I(o=>[o.value?(a(),i("span",oe,r(e(l).personsNames[o.value]),1)):(a(),i("span",se,r(o.placeholder),1))]),option:I(o=>[o.option?(a(),i("span",ae,r(o.option.firstname)+" "+r(o.option.lastname),1)):(a(),i("span",te,r(o.placeholder),1))]),_:1},8,["modelValue","options"])):(a(),d(e(f),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"})),V(e(S),{label:"Ajouter une personne",icon:"pi pi-plus",text:"",onClick:R})]),t("div",ne,[le,e(m).organisations?(a(),d(e(f),{key:1,modelValue:e(u),"onUpdate:modelValue":s[1]||(s[1]=o=>b(u)?u.value=o:null),options:e(m).organisations,optionLabel:"name",optionValue:"id",placeholder:"Choisir une organisation",class:"w-full",filter:""},null,8,["modelValue","options"])):(a(),d(e(f),{key:0,loading:"",placeholder:"Chargement en cours...",class:"w-full"}))]),t("div",ie,[re,V(e(z),{id:"role",type:"text",modelValue:e(p),"onUpdate:modelValue":s[2]||(s[2]=o=>b(p)?p.value=o:null),class:"w-full"},null,8,["modelValue"])]),V(e(S),{type:"submit",label:"Soumettre",class:"w-full",loading:v.value},null,8,["loading"])],40,X),(a(!0),i(j,null,D(e(F),(o,U)=>(a(),d(e(G),{severity:"error",key:U},{default:I(()=>[E(r(o),1)]),_:2},1024))),128))]))}};export{be as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/PersonsUpsertForm-QfBQsrWN.js","assets/index.esm-v6cDy30M.js","assets/index-om2yVH6z.js","assets/index-ZWerLMmy.css","assets/message.esm-43B1DmQ7.js","assets/index.esm-BEizDpwn.js","assets/textarea.esm-36WrxFgm.js","assets/editor.esm-z4GqcxJ7.js","assets/AppPicturesSelector-5_4xifco.js","assets/AppTableSkeleton-bFD8jdFV.js","assets/fileupload.esm-5wT2dkji.js","assets/index.esm-Ae9eXaSc.js","assets/format-39s6QTMr.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
