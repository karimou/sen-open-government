import{c as $,a as m,u as k,s as B}from"./message.esm-7AaCCNeN.js";import{b as I,s as R}from"./index.esm-vGdYQZef.js";import{s as U}from"./textarea.esm-Zp6g0_lQ.js";import{s as q}from"./editor.esm-M_ny7rpB.js";import{r as _,a0 as D,a as N,A as g,o as f,c as V,b as l,t as b,f as n,e as t,Y as v,F as j,v as E,k as M,w as T,g as z}from"./index-Tc2rU4CK.js";const C={style:{width:"650px"}},L=["initial-values"],P={class:"field"},Y=l("label",{for:"title"},"Titre",-1),G={class:"field"},H=l("label",{for:"short_description"},"Description courte",-1),J={class:"field"},K=l("label",{for:"short_description"},"Description longue",-1),oe={__name:"IssuesUpsertForm",setup(O){const y=$({title:m().required(),short_description:m().required(),long_description:m()}),{handleSubmit:x,errors:S,defineField:u,setFieldValue:w}=k({validationSchema:y}),[d,Q]=u("title"),[c,W]=u("short_description"),[p,X]=u("long_description"),a=_(null),A=_({}),i=D("dialogRef");N(()=>{var o;["title","short_description","long_description"].forEach(e=>{i.value.data[e]&&w(e,i.value.data[e])}),a.value=(o=i.value.data)==null?void 0:o.id});const r=_(!1),h=x(o=>{r.value=!0,a.value?g.issues.updateIssue({...o,id:a.value}).then(e=>{i.value.close()}).finally(()=>r.value=!1):g.issues.addIssue(o).then(e=>{i.value.close()}).finally(()=>r.value=!1)});return(o,e)=>(f(),V("div",C,[l("h5",null,b(a.value?"Modifier":"Ajouter")+" un thÃ¨me politique",1),l("form",{onSubmit:e[3]||(e[3]=(...s)=>t(h)&&t(h)(...s)),"initial-values":A.value.value},[l("div",P,[Y,n(t(I),{id:"title",type:"text",modelValue:t(d),"onUpdate:modelValue":e[0]||(e[0]=s=>v(d)?d.value=s:null),class:"w-full"},null,8,["modelValue"])]),l("div",G,[H,n(t(U),{id:"short_description",modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=s=>v(c)?c.value=s:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),l("div",J,[K,n(t(q),{modelValue:t(p),"onUpdate:modelValue":e[2]||(e[2]=s=>v(p)?p.value=s:null),id:"long_description",editorStyle:"height: 320px"},null,8,["modelValue"])]),n(t(R),{type:"submit",label:"Soumettre",class:"w-full",loading:r.value},null,8,["loading"])],40,L),(f(!0),V(j,null,E(t(S),(s,F)=>(f(),M(t(B),{severity:"error",key:F},{default:T(()=>[z(b(s),1)]),_:2},1024))),128))]))}};export{oe as default};
