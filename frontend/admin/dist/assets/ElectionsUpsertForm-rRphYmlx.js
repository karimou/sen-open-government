import{c as M,b as R,a as V,u as q,s as D}from"./message.esm-O7AaV-cU.js";import{b as A,s as N}from"./index.esm-_HLybhMr.js";import{s as j}from"./textarea.esm-u5kzhW9E.js";import{s as $}from"./radiobutton.esm-7FGAMpdP.js";import{r as b,X as L,o as P,A as x,a as h,c as E,b as a,E as F,g as d,f as l,V as n,F as T,n as z,e as C,w as I,h as X}from"./index-R5AkUM7P.js";import{f as G}from"./format-39s6QTMr.js";const H={style:{width:"450px"}},J=["initial-values"],K={class:"field"},O={class:"field-radiobutton"},Q=a("label",{for:"type1"},"Présidentielle",-1),W={class:"field-radiobutton"},Y=a("label",{for:"type2"},"Législatives",-1),Z={class:"field"},ee=a("label",{for:"title"},"Titre",-1),te={class:"field"},le=a("label",{for:"date"},"Date",-1),ae={class:"field"},se=a("label",{for:"description"},"Description",-1),_e={__name:"ElectionsUpsertForm",setup(ie){const S=M({date:R().required(),title:V().required(),type:V().required(),description:V()}),{handleSubmit:U,errors:k,defineField:u,setFieldValue:m}=q({validationSchema:S}),[f,oe]=u("date"),[v,de]=u("title"),[i,ne]=u("type"),[_,ue]=u("description"),r=b(null),B=b({}),s=L("dialogRef");P(()=>{var o,e,t,p,w;(o=s.value.data)!=null&&o.date&&m("date",G((e=s.value.data)==null?void 0:e.date,"yyyy-MM-dd")),m("type",((t=s.value.data)==null?void 0:t.type)=="click"?"presidential":(p=s.value.data)==null?void 0:p.type),["title","description"].forEach(y=>{s.value.data[y]&&m(y,s.value.data[y])}),r.value=(w=s.value.data)==null?void 0:w.id});const c=b(!1),g=U(o=>{c.value=!0,r.value?x.elections.updateElection({...o,id:r.value}).then(e=>{s.value.close("success")}).finally(()=>c.value=!1):x.elections.addElection(o).then(e=>{s.value.close("success")}).finally(()=>c.value=!1)});return(o,e)=>(h(),E("div",H,[a("h5",null,F(r.value?"Modifier":"Ajouter")+" une élection",1),a("form",{onSubmit:e[5]||(e[5]=(...t)=>l(g)&&l(g)(...t)),"initial-values":B.value.value},[a("div",K,[a("div",O,[d(l($),{id:"type1",name:"type",modelValue:l(i),"onUpdate:modelValue":e[0]||(e[0]=t=>n(i)?i.value=t:null),value:"presidential"},null,8,["modelValue"]),Q]),a("div",W,[d(l($),{id:"type2",name:"type",modelValue:l(i),"onUpdate:modelValue":e[1]||(e[1]=t=>n(i)?i.value=t:null),value:"parliament"},null,8,["modelValue"]),Y])]),a("div",Z,[ee,d(l(A),{id:"title",type:"text",modelValue:l(v),"onUpdate:modelValue":e[2]||(e[2]=t=>n(v)?v.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",te,[le,d(l(A),{id:"date",type:"date",modelValue:l(f),"onUpdate:modelValue":e[3]||(e[3]=t=>n(f)?f.value=t:null),class:"w-full"},null,8,["modelValue"])]),a("div",ae,[se,d(l(j),{id:"description",modelValue:l(_),"onUpdate:modelValue":e[4]||(e[4]=t=>n(_)?_.value=t:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),d(l(N),{type:"submit",label:"Soumettre",class:"w-full",loading:c.value},null,8,["loading"])],40,J),(h(!0),E(T,null,z(l(k),(t,p)=>(h(),C(l(D),{severity:"error",key:p},{default:I(()=>[X(F(t),1)]),_:2},1024))),128))]))}};export{_e as default};
