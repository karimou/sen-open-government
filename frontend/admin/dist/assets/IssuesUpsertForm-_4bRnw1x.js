import{c as U,a as d,u as k}from"./index.esm-7vlYWs5j.js";import{b as B,s as I}from"./index.esm-W4H87m11.js";import{s as R}from"./textarea.esm-FGC31d1c.js";import{s as q}from"./editor.esm-kq0G3DuG.js";import{s as D}from"./message.esm-FZNGV9Fe.js";import{r as v,X as E,o as N,A as V,a as h,c as b,b as o,E as y,g as a,f as t,V as c,F as j,n as M,e as T,w as z,h as C}from"./index-F1RqSK8B.js";import{_ as L}from"./AppPicturesSelector-2pmqlMqZ.js";import"./AppTableSkeleton-K44dyUfr.js";import"./fileupload.esm-_Xhm3CsQ.js";import"./index.esm-9dU2qWzq.js";const P={style:{width:"650px"}},X=["initial-values"],G={class:"field"},H=o("label",{for:"title"},"Titre",-1),J={class:"field"},K=o("label",{for:"short_description"},"Description courte",-1),O={class:"field"},Q=o("label",{for:"short_description"},"Description longue",-1),pe={__name:"IssuesUpsertForm",setup(W){const x=U({title:d().required(),short_description:d().required(),long_description:d(),photo:d()}),{handleSubmit:A,errors:S,defineField:r,setFieldValue:$}=k({validationSchema:x}),[p,Y]=r("title"),[m,Z]=r("short_description"),[_,ee]=r("long_description"),[f,te]=r("photo"),n=v(null),w=v({}),i=E("dialogRef");N(()=>{var l;["title","short_description","long_description","photo"].forEach(e=>{i.value.data[e]&&$(e,i.value.data[e])}),n.value=(l=i.value.data)==null?void 0:l.id});const u=v(!1),g=A(l=>{u.value=!0,n.value?V.issues.updateIssue({...l,id:n.value}).then(e=>{i.value.close("success")}).finally(()=>u.value=!1):V.issues.addIssue(l).then(e=>{i.value.close("success")}).finally(()=>u.value=!1)});return(l,e)=>(h(),b("div",P,[o("h5",null,y(n.value?"Modifier":"Ajouter")+" un thÃ¨me politique",1),o("form",{onSubmit:e[4]||(e[4]=(...s)=>t(g)&&t(g)(...s)),"initial-values":w.value.value},[a(L,{image:t(f),"onUpdate:image":e[0]||(e[0]=s=>c(f)?f.value=s:null)},null,8,["image"]),o("div",G,[H,a(t(B),{id:"title",type:"text",modelValue:t(p),"onUpdate:modelValue":e[1]||(e[1]=s=>c(p)?p.value=s:null),class:"w-full"},null,8,["modelValue"])]),o("div",J,[K,a(t(R),{id:"short_description",modelValue:t(m),"onUpdate:modelValue":e[2]||(e[2]=s=>c(m)?m.value=s:null),class:"w-full",autoResize:!0},null,8,["modelValue"])]),o("div",O,[Q,a(t(q),{modelValue:t(_),"onUpdate:modelValue":e[3]||(e[3]=s=>c(_)?_.value=s:null),id:"long_description",editorStyle:"height: 320px"},null,8,["modelValue"])]),a(t(I),{type:"submit",label:"Soumettre",class:"w-full",loading:u.value},null,8,["loading"])],40,X),(h(!0),b(j,null,M(t(S),(s,F)=>(h(),T(t(D),{severity:"error",key:F},{default:z(()=>[C(y(s),1)]),_:2},1024))),128))]))}};export{pe as default};
